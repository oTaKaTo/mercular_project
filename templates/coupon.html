<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="{{ url_for('styles', path='coupon.css?v=1') }}" >
  {% include "global_head.html" %}
</head>
<body>
  {% include "nav-bar.html" %}
>>>>>>> Stashed changes
  <div class="popup-background" id="popup-background" onclick="close_popup()"></div>
  {% for type in coupons %}
    {% for coupon in coupons[type] %}
      <div class="popup-container" id="popup-{{coupon.get_id()}}">
        <div class="coupon-container">
          <div class="circle-top"></div>
          <div class="coupon-discount">
            <div class="text">
              ลดเพิ่ม
            </div>
            <div class="discount">
              {{coupon.get_discount_str()}}
            </div>
          </div>
          <div class="coupon-description">
            <div class="title">{{coupon.get_title()}}</div>
            <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
            <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
          </div>
          <div class="coupon-button"></div>
          <div class="circle-bottom"></div>
        </div>
        <div class="description-container">
          <div class="description-title">เงื่อนไขการใช้คูปอง</div>
          <div class="condition">คูปองส่วนลด {{coupon.get_discount_str()}} ต่อใบเสร็จ เมื่อมียอดซื้อขั้นต่ำ {{coupon.get_minimum_price_str()}}</div>
          <div class="description-title">ระยะเวลา</div>
          <div class="condition">วันนี้ - {{coupon.get_due_date_str()}}</div>
          <div class="description-title">หมวดสินค้าที่สามารถใช้ร่วมกับคูปองได้</div>
          {% for type in coupon.get_types() %}
          <div class="condition">{{type}}</div>
          {% endfor %}
          <div class="button-container">
            <div class="get-code-button" id="B{{coupon.get_id()}}" onclick="get_coupon(this.id, '{{email}}')">เก็บคูปอง</div>
            <div class="close-button" onclick="close_popup()">ปิด</div>
          </div>
        </div>
      </div>
    {% endfor %}
  {% endfor %}
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/08/brand%20page/Coupon_special/Coupon_LDP-01.jpg">
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/08/brand%20page/Coupon_special/Coupon_LDP-05.jpg">
  </div>
  <div class="row-container">
    {% for coupon in coupons['exclusive'] %}
      <div class="coupon-container" onclick="show_popup({{coupon.get_id()}})" id="{{coupon.get_id()}}">
        <div class="circle-top"></div>
        <div class="coupon-discount">
          <div class="text">
            ลดเพิ่ม
          </div>
          <div class="discount">
            {{coupon.get_discount_str()}}
          </div>
        </div>
        <div class="coupon-description">
          <div class="title">{{coupon.get_title()}}</div>
          <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
          <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
        </div>
        <div class="coupon-button"></div>
        <div class="circle-bottom"></div>
        <div class="button"><div class="text">เก็บคูปอง</div></div>
      </div>
    {% endfor %}
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/11/coupon_special/Always-on%20-%20Coupon%20Special_7.jpg">
  </div>
  <div class="row-container">
    {% for coupon in coupons['speaker'] %}
      <div class="coupon-container" onclick="show_popup({{coupon.get_id()}})" id="{{coupon.get_id()}}">
        <div class="circle-top"></div>
        <div class="coupon-discount">
          <div class="text">
            ลดเพิ่ม
          </div>
          <div class="discount">
            {{coupon.get_discount_str()}}
          </div>
        </div>
        <div class="coupon-description">
          <div class="title">{{coupon.get_title()}}</div>
          <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
          <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
        </div>
        <div class="coupon-button"></div>
        <div class="circle-bottom"></div>
        <div class="button"><div class="text">เก็บคูปอง</div></div>
      </div>
    {% endfor %}
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/11/coupon_special/Always-on%20-%20Coupon%20Special_9.jpg">
  </div>
  <div class="row-container">
    {% for coupon in coupons['gaming'] %}
      <div class="coupon-container" onclick="show_popup({{coupon.get_id()}})" id="{{coupon.get_id()}}">
        <div class="circle-top"></div>
        <div class="coupon-discount">
          <div class="text">
            ลดเพิ่ม
          </div>
          <div class="discount">
            {{coupon.get_discount_str()}}
          </div>
        </div>
        <div class="coupon-description">
          <div class="title">{{coupon.get_title()}}</div>
          <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
          <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
        </div>
        <div class="coupon-button"></div>
        <div class="circle-bottom"></div>
        <div class="button"><div class="text">เก็บคูปอง</div></div>
      </div>
    {% endfor %}
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/11/coupon_special/Always-on%20-%20Coupon%20Special_11.jpg">
  </div>
  <div class="row-container">
    {% for coupon in coupons['computer'] %}
      <div class="coupon-container" onclick="show_popup({{coupon.get_id()}})" id="{{coupon.get_id()}}">
        <div class="circle-top"></div>
        <div class="coupon-discount">
          <div class="text">
            ลดเพิ่ม
          </div>
          <div class="discount">
            {{coupon.get_discount_str()}}
          </div>
        </div>
        <div class="coupon-description">
          <div class="title">{{coupon.get_title()}}</div>
          <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
          <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
        </div>
        <div class="coupon-button"></div>
        <div class="circle-bottom"></div>
        <div class="button"><div class="text">เก็บคูปอง</div></div>
      </div>
    {% endfor %}
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/11/coupon_special/Always-on%20-%20Coupon%20Special_13.jpg">
  </div>
  <div class="row-container">
    {% for coupon in coupons['table'] %}
      <div class="coupon-container" onclick="show_popup({{coupon.get_id()}})" id="{{coupon.get_id()}}">
        <div class="circle-top"></div>
        <div class="coupon-discount">
          <div class="text">
            ลดเพิ่ม
          </div>
          <div class="discount">
            {{coupon.get_discount_str()}}
          </div>
        </div>
        <div class="coupon-description">
          <div class="title">{{coupon.get_title()}}</div>
          <div class="description">เมื่อซื้อครบ {{coupon.get_minimum_price_str()}}</div>
          <div class="due-date">หมดอายุ : {{coupon.get_due_date_str()}}</div>
        </div>
        <div class="coupon-button"></div>
        <div class="circle-bottom"></div>
        <div class="button"><div class="text">เก็บคูปอง</div></div>
      </div>
    {% endfor %}
  </div>
  <div class="img-container">
    <img src="https://mercular.s3.ap-southeast-1.amazonaws.com/images/products/2022/11/coupon_special/Always-on%20-%20Coupon%20Special_5.jpg">
  </div>
  <script>
    var current_popup_id = 0

    function get_coupon(id, email){
      id = id.slice(1)
      fetch('http://127.0.0.1:8000/' + email + '/get-coupon', {method: 'POST',
      body: JSON.stringify({'email': email, 'id': id}),
      headers: {'Content-Type': 'application/json'}
      }).then(response => response.json()).then(data => {alert(data)})
    }
    
    function show_popup(id){
      current_popup_id = id
      document.getElementById("popup-" + id).style.display = "flex"
      document.getElementById("popup-background").style.display = "block"
      document.body.style.overflowY = "hidden"
    }
    function close_popup(){
      document.getElementById("popup-" + current_popup_id).style.display = "none"
      document.getElementById("popup-background").style.display = "none"
      document.body.style.overflowY = "scroll"
    }
    </script>
</body>
</html>